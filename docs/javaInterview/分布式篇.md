> 五、**分布式篇**
- [互联网架构的变迁之路](#互联网架构的变迁之路)
- [SOA（分布式）](#soa分布式)
    - [公司服务方式](#公司服务方式)
    - [RPC](#rpc)
    - [webService](#webservice)
- [Dubbo](#dubbo)
        - [Dubbo能做什么？](#dubbo能做什么)
        - [如果注册中心不可用,那么服务消费者还能调用服务么?](#如果注册中心不可用那么服务消费者还能调用服务么)
        - [dubbo默认失败重试次数以及超时时间](#dubbo默认失败重试次数以及超时时间)
        - [扩展：BIO、NIO、AIO有什么区别?](#扩展bionioaio有什么区别)
- [分布式锁](#分布式锁)
    - [redis实现](#redis实现)
    - [zookeeper实现](#zookeeper实现)
- [Zookeeper](#zookeeper)
- [Nginx](#nginx)
    - [请解释一下什么是Nginx?](#请解释一下什么是nginx)
    - [请列举Nginx的一些特性。](#请列举nginx的一些特性)
    - [请解释Nginx如何处理HTTP请求。](#请解释nginx如何处理http请求)
    - [使用“反向代理服务器”的优点是什么?](#使用反向代理服务器的优点是什么)
    - [请列举Nginx服务器的最佳用途。](#请列举nginx服务器的最佳用途)
    - [请解释Nginx服务器上的Master和Worker进程分别是什么?](#请解释nginx服务器上的master和worker进程分别是什么)
____
### 互联网架构的变迁之路
单体架构阶段>>垂直架构阶段>>SOA架构阶段>>微服务架构阶段
### SOA（分布式）
  面向服务的架构（SOA）是一个组件模型，它将应用程序的不同功能单元（称为服务）进行拆分，并通过这些服务之间定义良好的接口和协议联系起来。
  接口是采用中立的方式进行定义的，它应该独立于实现服务的硬件平台、操作系统和编程语言。这使得构建在各种各样的系统中的服务可以以一种统一和通用的方式进行交互。
  SOA架构的核心是***RPC和MQ***
#### 公司服务方式
  IaaS（Infrastructure as a Service），即基础设施即服务。指把IT基础设施作为一种服务通过网络对外提供，并根据用户对资源的实际使用量或占用量进行计费的一种服务模式。
  PaaS是（Platform as a Service），是指平台即服务。 把服务器平台作为一种服务提供的商业模式
  SaaS平台供应商将应用软件统一部署在自己的服务器上，客户可以根据工作实际需求，通过互联网向厂商定购所需的应用软件服务，按定购的服务多少和时间长短向厂商支付费用，并通过互联网获得Saas平台供应商提供的服务RPC 
#### RPC
  即远程过程调用 
  RPC有三要素 socket 动态代理 序列化
  RPC的常用技术实现  hessian thrift  avro   soapWebService
#### webService
  1:基于rest协议的webService接口  http+json (互联网项目)
  2:基于soap协议的webService接口  （传统型项目)
         简单对象访问协议
	     http
	     xml
	     wsdl 
###Dubbo
    dubbo是阿里开源的一个分布式服务治理rpc框架,主要用于服务拆分
    dubbo提供了注册中心的机制,注册中心支持zookeeper、redis、memcached等。我们在项目当中使用zookeeper集群来充当dubbo的注册中心。
    dubbo支持多种rpc协议,比如dubbo、hessian、thrift等
    使用dubbo协议进行rpc,dubbo协议是基于netty的nio的http长连接,
    dubbo还提供了心跳检测机制。dubbo除了注册中心之外,还提供了dubbo-admin dubbo-monitor进行服务监控和预警。
    Dubbo采用全Spring配置方式，透明化接入应用，对应用没有任何API侵入，只需用Spring加载Dubbo的配置即可。
1.1远程通讯: 
提供对多种基于长连接的NIO框架抽象封装，包括多种线程模型，序列化，以及“请求-响应”模式的信息交换方式。

1.2集群容错三种方式:
   Failover
   Failback
   Failfast策略
1.3 服务发现机制
      1:服务提供者启动之后,会向注册中心注册自己的服务名和服务地址
      2:服务消费者启动之后,会向注册中心订阅指定的服务
      3:注册中心会向服务消费者推送所订阅服务的地址列表(如服务提供者地址变更也会重新推送)
      4:服务消费者通过负载均衡策略,选择一个地址,进行rpc调用
##### Dubbo能做什么？

1、透明化的远程方法调用，就像调用本地方法一样调用远程方法，只需简单配置，没有任何API侵入。

2、软负载均衡及容错机制，可在内网替代F5等硬件负载均衡器，降低成本，减少单点。

3、服务自动注册与发现，不再需要写死服务提供方地址，注册中心基于接口名查询服务提供者的IP地址，并且能够平滑添加或删除服务提供者。

##### 如果注册中心不可用,那么服务消费者还能调用服务么?
       dubbo提供了服务的本地缓存机制,短期之内,服务消费者还是可以调用服务的
        问：现在我有两套环境,一套是开发环境,一套是测试环境,共用同一个注册中心,如果保障开发环境的服务消费者调用的一定是开发环境的服务提供者？
        答：在发布和订阅服务的时候指定group或version
##### dubbo默认失败重试次数以及超时时间
    失败重试2次  1000毫秒，可以根据业务场景，手动设置

##### 扩展：BIO、NIO、AIO有什么区别?
      BIO  同步阻塞的io,客户端发起连接之后,直到响应,这当中一直是阻塞状态(tomcat默认BIO)
      NIO  同步非阻塞,服务器实现模式为一个请求一个线程,
      即客户端发送的连接请求都会注册到多路复用器上,
      多路复用器轮询到连接有I/O请求时才启动一个线程进行处理。（netty、tomcat调优）
      AIO  异步的io （linux native AIO）

### 分布式锁
#### redis实现
#### zookeeper实现
### Zookeeper
### Nginx
#### 请解释一下什么是Nginx?
     Nginx是一个web服务器和方向代理服务器，用于HTTP、HTTPS、SMTP、POP3和IMAP协议。
#### 请列举Nginx的一些特性。
     反向代理/L7负载均衡器
     嵌入式Perl解释器
     动态二进制升级
     可用于重新编写URL，具有非常好的PCRE支持
#### 请解释Nginx如何处理HTTP请求。
    Nginx使用反应器模式。主事件循环等待操作系统发出准备事件的信号，这样数据就可以从套接字读取，在该实例中读取到缓冲区并进行处理。单个线程可以提供数万个并发连接。
#### 使用“反向代理服务器”的优点是什么?
反向代理服务器可以隐藏源服务器的存在和特征。它充当互联网云和web服务器之间的中间层。这对于安全方面来说是很好的，特别是当您使用web托管服务时。
#### 请列举Nginx服务器的最佳用途。
Nginx服务器的最佳用法是在网络上部署动态HTTP内容，使用SCGI、WSGI应用程序服务器、用于脚本的FastCGI处理程序。它还可以作为负载均衡器。
#### 请解释Nginx服务器上的Master和Worker进程分别是什么?
Master进程：读取及评估配置和维持
Worker进程：处理请求
